{% extends 'dashboard/base.html' %}

{% block content %}

    <h3 class="display-3">Search your building by address:</h3>

    <label for="addressSearch">
        <input type="text" class="addressSearch">
    </label>

    <script>

        $('.addressSearch').keyup(updateCount)
                            .keydown(updateCount);
        let cs = 0

        function updateCount() {
            cs = $(this).val().length;

            csval = $(this).val();

            $('#characters').text(cs);

            if(cs > 3) {

                let apicall = 'https://geosearch.planninglabs.nyc/v2/autocomplete?text=' + csval;

                let request = new XMLHttpRequest();

                request.open('GET', apicall, true);

                request.onload = function() {

                    let data = JSON.parse(this.response);

                    console.log(typeof(data));

                    data.features.forEach((address) => {
                        console.log((address.properties.label));
                    })

                }

                request.send()
            }

        }

        console.log(cs)
    </script>
{% endblock content %}

